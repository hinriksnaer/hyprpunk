#!/usr/bin/env fish
# Refresh/reapply the current theme (useful after config changes)
# Usage: fedpunk-theme-refresh

set active_theme_conf "$HOME/.config/hypr/active-theme.conf"

# Extract current theme from active-theme.conf
if not test -f "$active_theme_conf"
    echo "Error: No active-theme.conf found"
    echo "Run 'fedpunk theme set <theme-name>' first"
    exit 1
end

set current_line (grep "source.*themes.*hyprland.conf" "$active_theme_conf" 2>/dev/null)

if test -n "$current_line"
    set theme_name (echo $current_line | sed 's|.*themes/\([^/]*\)/.*|\1|')
    echo "Refreshing theme: $theme_name"
    fedpunk-theme-set $theme_name
else
    echo "Error: Could not detect theme from active-theme.conf"
    echo "File contents:"
    cat "$active_theme_conf"
    exit 1
end
